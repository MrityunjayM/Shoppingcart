<%- include('../layouts/adminheader'); -%>

    <h2 class="page-title">Products</h2>

    <a href="/admin/products/add-product" class="btn btn-primary">Add a new product</a>
    <br>

    <table class="table table-striped alignmiddle">
        <thead>
            <tr class="home">
                <th>Product</th>
                <th>Price</th>
                <th>Category</th>
                <th>Product Image</th>
                <th>Edit</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody>
            <% products.forEach(function(product){ %>
                <tr>
                    <td>
                        <%= product.title %>
                    </td>
                    
                    <td>
                        $<%= product.price %>
                    </td>

                    <td>
                        <%= product.category.title %>
                    </td>

                    <td>
                        <div id="productCarousel" class="carousel slide" data-bs-ride="carousel">
                            <div class="carousel-inner">
                                <% product.images.forEach((img, i)=> { %>
                                    <div class="carousel-item <%= i === 0 ? 'active' : ''%>">
                                        <img src="<%= img.thumbnail%>" class="d-block w-100" alt="">
                                    </div>
                                <% }) %>
                            </div>
                            <% if(product.images.length> 1) {%>
                                <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel"
                                    data-bs-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Previous</span>
                                </button>
                                <button class="carousel-control-next" type="button" data-bs-target="#productCarousel"
                                    data-bs-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Next</span>
                                </button>
                            <% } %>
                        </div>
                    </td>

                    <td>
                        <a href="/admin/products/edit-product/<%= product._id %>" class="text-primary">
                            <%- include('../partials/editButton'); %>
                        </a>
                    </td>
                    
                    <td>
                        <a class="confirmDeletion text-danger" href="/admin/products/edit-product/<%= product._id %>/delete">
                            <%- include('../partials/deleteButton'); %>
                        </a>
                    </td>
                </tr>
                <% }); %>
        </tbody>
    </table>

<%- include('../layouts/adminfooter'); -%>